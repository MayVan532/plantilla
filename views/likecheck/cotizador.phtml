<div class="section-container" id="cotizador-content" style="padding: 40px 0 80px; background: #ffffff; position: relative; overflow: hidden;">
    <?php 
      // Solo agenda aquí; WhatsApp se normaliza más abajo igual que en Empresas
      $agendaLink = $this->lc_cotizador_agenda_link ?? null;
    ?>
    <?php if (!empty($_GET['debugcms'])) { ?>
      <pre style="background:#111;color:#0f0;padding:10px;font-size:11px;max-width:100%;overflow:auto;">
DEBUG lc_cotizador_whatsapp:
<?php var_export($this->lc_cotizador_whatsapp ?? null); ?>

DEBUG lc_cotizador_whatsapp_link:
<?php var_export($this->lc_cotizador_whatsapp_link ?? null); ?>
      </pre>
    <?php } ?>
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h2 style="color: #182c83; font-size: 2.5rem; font-weight: 700; text-transform: uppercase; margin-bottom: 2rem; padding-top: 20px; font-family: 'Poppins', sans-serif; letter-spacing: 1px;">
                COTIZADOR
            </h2>
        </div>
    </div>
    <div style="display:none"></div>
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="mb-5" style="animation: fadeInDown 0.8s ease-out both;">
                        <div class="text-center mb-3" style="font-size: 1.4rem; font-weight: 600; color: #182c83; font-family: 'Montserrat', sans-serif; position: relative; display: inline-block;">
                            <i class="fas fa-coins" style="margin-right: 8px; color: #0799B6;"></i>Moneda
                            <div style="position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); width: 40px; height: 3px; background: linear-gradient(90deg, #0799B6, #182c83); border-radius: 2px;"></div>
                        </div>
                        <div class="form-group">
                            <div class="currency-selector" style="max-width: 300px; margin: 10px auto; border: none; border-radius: 12px; background-color: white; overflow: hidden; position: relative; height: 54px; cursor: pointer; box-shadow: 0 6px 16px rgba(7, 153, 182, 0.15); transition: all 0.3s ease;">
                                <div style="position: absolute; left: 0; top: 0; height: 100%; width: 5px; background: linear-gradient(to bottom, #0799B6, #182c83);"></div>
                                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; padding: 0 20px; font-weight: 600; color: #182c83; font-size: 1.2rem;">
                                        <span>Peso Mexicano ($)</span>
                                    </div>
                                    <div class="selector-icon" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); pointer-events: none; z-index: 1;">
                                        <span style="background: linear-gradient(135deg, #0799B6, #182c83); border: none; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;"><i class="fas fa-check" style="color: white; font-size: 0.8rem;"></i></span>
                                    </div>
                                </div>
                            </div>
                            <script>
                                document.querySelector('.currency-selector').addEventListener('mouseenter', function() {
                                    this.style.transform = 'translateY(-3px)';
                                    this.style.boxShadow = '0 10px 20px rgba(7, 153, 182, 0.2)';
                                });
                                document.querySelector('.currency-selector').addEventListener('mouseleave', function() {
                                    this.style.transform = '';
                                    this.style.boxShadow = '0 6px 16px rgba(7, 153, 182, 0.15)';
                                });
                                </script>
                            </div>
                            <div class="row mt-5">
                                <div class="col-md-6">
                                    <div style="background: linear-gradient(135deg, #0799B6, #182c83); border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(7, 153, 182, 0.25); animation: fadeInLeft 1s ease-out both; transition: all 0.4s ease; position: relative; overflow: hidden;" class="config-panel hover-lift">                                     
                                        <div style="position: absolute; top: 0; right: 0; width: 150px; height: 150px; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%); border-radius: 50%; z-index: 1;"></div>
                                        <div class="d-flex align-items-center mb-4">
                                            <div style="background: rgba(255,255,255,0.2); width: 40px; height: 40px; border-radius: 12px; display: flex; justify-content: center; align-items: center; margin-right: 12px;">
                                                <i class="fas fa-sliders-h" style="color: white; font-size: 1.2rem;"></i>
                                            </div>
                                            <h3 style="color: white; font-weight: 600; font-size: 1.4rem; margin: 0; font-family: 'Montserrat', sans-serif;">Configurar Plan</h3>
                                        </div>                               
                                        <div style="margin-bottom: 25px;">
                                            <div style="color: white; font-size: 1rem; margin-bottom: 10px; opacity: 0.9; font-family: 'Montserrat', sans-serif;">Selecciona periodicidad:</div>
                                            <div class="period-selector d-flex justify-content-between" style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 5px; position: relative;">
                                                <button class="period-btn active" data-frequency="Mensual" data-price="35" style="flex: 1; border: none; background: white; border-radius: 10px; padding: 12px 5px; margin: 0 3px; font-weight: 600; color: #0799B6; font-size: 0.9rem; position: relative; z-index: 1; transition: all 0.3s ease; box-shadow: 0 3px 8px rgba(0,0,0,0.1);">
                                                    <div style="position: relative; z-index: 2;">Mensual</div>
                                                </button>
                                                <button class="period-btn" data-frequency="Semestral" data-price="180" style="flex: 1; border: none; background: rgba(255,255,255,0.2); border-radius: 10px; padding: 12px 5px; margin: 0 3px; font-weight: 600; color: white; font-size: 0.9rem; transition: all 0.3s ease;">
                                                    <div style="position: relative; z-index: 2;">Semestral</div>
                                                </button>
                                                <button class="period-btn" data-frequency="Anual" data-price="300" style="flex: 1; border: none; background: rgba(255,255,255,0.2); border-radius: 10px; padding: 12px 5px; margin: 0 3px; font-weight: 600; color: white; font-size: 0.9rem; transition: all 0.3s ease;">
                                                    <div style="position: relative; z-index: 2;">Anual</div>
                                                </button>
                                            </div>
                                        </div>
                                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px 15px; margin-bottom: 20px; animation: fadeIn 0.8s ease-out 0.4s both;">
                                            <h3 style="color: white; font-weight: 500; font-size: 1.1rem; text-align: center; margin-bottom: 15px; font-family: 'Montserrat', sans-serif;">
                                                <i class="fas fa-users" style="margin-right: 8px; opacity: 0.9;"></i>Número de colaboradores
                                            </h3>
                                            <div class="counter-container d-flex justify-content-center align-items-center" style="background: linear-gradient(to right, rgba(255,255,255,0.2), rgba(255,255,255,0.1)); border-radius: 15px; padding: 12px; position: relative; overflow: hidden;">
                                                <button class="btn btn-circle minus-btn" style="width: 48px; height: 48px; border-radius: 50%; background: rgba(255,255,255,0.95); color: #0799B6; font-size: 1.4rem; display: flex; align-items: center; justify-content: center; margin-right: 20px; transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border: none; font-weight: bold; animation: bounceIn 0.6s 0.1s both;">
                                                    <i class="fas fa-minus" style="font-size: 0.8rem;"></i>
                                                </button>
                                                <div style="position: relative;">
                                                    <span class="counter-number" contenteditable="true" inputmode="numeric" style="font-size: 3.2rem; font-weight: 700; color: white; padding: 0 20px; animation: fadeIn 1s both; display: inline-block; min-width: 90px; text-align: center; text-shadow: 0 2px 4px rgba(0,0,0,0.1); font-family: 'Montserrat', sans-serif;">1</span>
                                                    <div style="position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); width: 60%; height: 4px; background: rgba(255,255,255,0.4); border-radius: 2px;"></div>
                                                </div>
                                                <button class="btn btn-circle plus-btn" style="width: 48px; height: 48px; border-radius: 50%; background: rgba(255,255,255,0.95); color: #0799B6; font-size: 1.4rem; display: flex; align-items: center; justify-content: center; margin-left: 20px; transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border: none; font-weight: bold; animation: bounceIn 0.6s both;">
                                                    <i class="fas fa-plus" style="font-size: 0.8rem;"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="likephone-option d-flex justify-content-between align-items-center" style="background: rgba(255,255,255,0.95); border-radius: 12px; padding: 15px; transition: all 0.3s ease; animation: fadeIn 0.8s ease-out 0.6s both; cursor: pointer;">
                                            <div class="d-flex align-items-center">
                                                <div style="background: linear-gradient(135deg, #0799B6, #182c83); width: 36px; height: 36px; border-radius: 10px; display: flex; justify-content: center; align-items: center; margin-right: 15px;">
                                                    <i class="fas fa-mobile-alt" style="color: white;"></i>
                                                </div>
                                                <span style="font-weight: 600; color: #182c83; font-size: 1.1rem; font-family: 'Montserrat', sans-serif;">Líneas LikePhone</span>
                                            </div>
                                            <div class="toggle-switch" tabindex="0" style="background-color: #ccc; width: 50px; height: 26px; border-radius: 13px; position: relative; transition: all 0.3s ease; box-shadow: inset 0 0 5px rgba(0,0,0,0.2); cursor: pointer; pointer-events: auto;">
                                                <div class="toggle-knob" style="position: absolute; width: 20px; height: 20px; background-color: white; border-radius: 50%; top: 3px; left: 3px; right: auto; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                            </div>
                                        </div>                             
                                        <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px 15px; margin-bottom: 20px; margin-top: 20px; display: none; animation: fadeIn 0.8s ease-out 0.5s both;">
                                            <h3 style="color: white; font-weight: 500; font-size: 1.1rem; text-align: center; margin-bottom: 15px; font-family: 'Montserrat', sans-serif;">
                                                <i class="fas fa-mobile-alt" style="margin-right: 8px; opacity: 0.9;"></i>Número de líneas Likephone
                                            </h3>
                                            <div class="likephone-counter-container d-flex justify-content-center align-items-center" style="background: linear-gradient(to right, rgba(255,255,255,0.2), rgba(255,255,255,0.1)); border-radius: 15px; padding: 12px; position: relative; overflow: hidden;">
                                                <button class="btn btn-circle likephone-minus-btn" style="width: 48px; height: 48px; border-radius: 50%; background: rgba(255,255,255,0.95); color: #0799B6; font-size: 1.4rem; display: flex; align-items: center; justify-content: center; margin-right: 20px; transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border: none; font-weight: bold; animation: bounceIn 0.6s 0.2s both;">
                                                    <i class="fas fa-minus" style="font-size: 0.8rem;"></i>
                                                </button>
                                                <div style="position: relative;">
                                                    <span class="likephone-counter-number" contenteditable="true" inputmode="numeric" style="font-size: 2.4rem; font-weight: 700; color: white; padding: 0 20px; animation: fadeIn 1s both; display: inline-block; min-width: 70px; text-align: center; text-shadow: 0 2px 4px rgba(0,0,0,0.05); font-family: 'Montserrat', sans-serif;">0</span>
                                                    <div style="position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); width: 60%; height: 4px; background: rgba(255,255,255,0.4); border-radius: 2px;"></div>
                                                </div>
                                                <button class="btn btn-circle likephone-plus-btn" style="width: 48px; height: 48px; border-radius: 50%; background: rgba(255,255,255,0.95); color: #0799B6; font-size: 1.4rem; display: flex; align-items: center; justify-content: center; margin-left: 20px; transition: all 0.3s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border: none; font-weight: bold; animation: bounceIn 0.6s 0.2s both;">
                                                    <i class="fas fa-plus" style="font-size: 0.8rem;"></i>
                                                </button>
                                            </div>
                                        </div>                                   
                                    </div>
                                </div>                             
                                <div class="col-md-6">
                                    <div style="background: white; color: #182c83; border-radius: 20px; padding: 30px; height: 100%; box-shadow: 0 10px 30px rgba(0,0,0,0.1); animation: fadeInRight 1s ease-out both; transition: all 0.4s ease; position: relative; overflow: hidden;" class="summary-panel hover-lift">
                                        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: linear-gradient(90deg, #0799B6, #182c83); border-radius: 3px 3px 0 0;"></div>                                            
                                        <div class="text-center mb-4">
                                            <div style="display: inline-block; position: relative;">
                                                <h3 style="margin-bottom: 0; font-weight: 700; font-size: 2rem; text-align: center; font-family: 'Montserrat', sans-serif; background: linear-gradient(90deg, #0799B6, #182c83); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">Tu Plan LikeCheck</h3>
                                                <div style="position: absolute; bottom: -5px; left: 0; width: 100%; height: 3px; background: linear-gradient(90deg, #0799B6, transparent); border-radius: 2px;"></div>
                                            </div>
                                        </div>
                                        <div style="border: 2px solid #f0f4f8; border-radius: 12px; padding: 20px; position: relative; margin-bottom: 20px; background: linear-gradient(145deg, #f8fbff, #f0f4f8); box-shadow: 0 3px 12px rgba(7, 153, 182, 0.05);">
                                            <ul class="list-unstyled" style="margin-bottom: 0;" id="benefits-list">
                                                <li style="margin-bottom: 16px; display: flex; align-items: center; opacity: 0; transform: translateX(20px);">
                                                    <div style="min-width: 30px; height: 30px; border-radius: 50%; background: linear-gradient(135deg, #0799B6, #182c83); display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 3px 8px rgba(7, 153, 182, 0.2);">
                                                        <i class="fas fa-users" style="color: white; font-size: 0.9rem;"></i>
                                                    </div>
                                                    <span id="employee-count-display" style="font-weight: 600; color: #182c83; font-size: 1.05rem; font-family: 'Montserrat', sans-serif;">1 empleado</span>
                                                </li>
                                                <li style="margin-bottom: 16px; display: flex; align-items: start; opacity: 0; transform: translateX(20px);">
                                                    <div style="min-width: 30px; height: 30px; border-radius: 50%; background: linear-gradient(135deg, #0799B6, #182c83); display: flex; align-items: center; justify-content: center; margin-right: 12px; margin-top: 2px; box-shadow: 0 3px 8px rgba(7, 153, 182, 0.2);">
                                                        <i class="fas fa-fingerprint" style="color: white; font-size: 0.9rem;"></i>
                                                    </div>
                                                    <span style="font-weight: 600; color: #182c83; font-size: 1.05rem; line-height: 1.4; font-family: 'Montserrat', sans-serif;">Control con reconocimiento facial y geolocalización inteligente</span>
                                                </li>
                                                <li style="margin-bottom: 0; display: flex; align-items: center; opacity: 0; transform: translateX(20px);">
                                                    <div style="min-width: 30px; height: 30px; border-radius: 50%; background: linear-gradient(135deg, #0799B6, #182c83); display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 3px 8px rgba(7, 153, 182, 0.2);">
                                                        <i class="fas fa-calendar-alt" style="color: white; font-size: 0.9rem;"></i>
                                                    </div>
                                                     <span id="frequency-display" style="font-weight: 600; color: #182c83; font-size: 1.05rem; font-family: 'Montserrat', sans-serif;">Frecuencia de pago: Mensual</span>
                                                </li>
                                            </ul>
                                        </div>
                                        <div style="margin-top: 25px; background: linear-gradient(135deg, #0799B6, #182c83); border-radius: 12px; padding: 18px; position: relative; box-shadow: 0 8px 20px rgba(7, 153, 182, 0.25); ">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <span style="font-weight: 600; font-size: 1.2rem; color: white; font-family: 'Montserrat', sans-serif;">Total a pagar</span>
                                                <div style="background-color: rgba(255,255,255,0.95); border-radius: 8px; padding: 8px 16px; font-weight: 700; position: relative; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                                                    <span id="total-price" style="background: linear-gradient(90deg, #0799B6, #182c83); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.5rem; font-family: 'Montserrat', sans-serif;">$875</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="likephone-note" style="font-size: 0.97rem; color: #444; margin-top: 8px; margin-bottom: 8px; display: none;">
                                            <strong>Nota:</strong> Por cada compra de 1 linea Likephone se descuenta a 1 usuario Likecheck.
                                            Solo aplica si se mantiene una recarga activa de la línea contratada.
                                        </div>
                                        <div class="likephone-new-amount-container" style="
                                            margin-top: 18px;
                                            background: linear-gradient(90deg, #0799B6 0%, #182c83 100%);
                                            border-radius: 18px;
                                            padding: 20px 24px;
                                            position: relative;
                                            box-shadow: 0 8px 20px rgba(7, 153, 182, 0.12);
                                            display: none;
                                            flex-wrap: wrap; /* Permite que los elementos bajen si no caben */
                                            justify-content: space-between;
                                            align-items: center;
                                            animation: fadeIn 1s both, pulse 2s infinite;
                                            animation-delay: 1.5s;
                                            max-width: 100%;
                                            box-sizing: border-box;
                                            ">
                                            <span style="
                                                font-weight: 700;
                                                font-size: 1.35rem;
                                                color: #fff;
                                                font-family: 'Montserrat', sans-serif;
                                                letter-spacing: 0.01em;
                                                flex: 1;
                                                min-width: 150px;
                                            ">
                                                Nuevo monto Likephone
                                            </span>
                                            <span id="likecheck-new-amount" style="
                                                background: #fff;
                                                color: #0799B6;
                                                font-weight: 700;
                                                font-size: 1.8rem;
                                                border-radius: 12px;
                                                padding: 8px 16px; /* REDUCIDO de 32px */
                                                margin-left: 20px;
                                                font-family: 'Montserrat', sans-serif;
                                                box-shadow: 0 2px 8px rgba(7,153,182,0.12);
                                                display: inline-block;
                                                min-width: 110px;
                                                text-align: center;
                                                word-break: break-word;
                                                max-width: 100%;
                                            ">
                                                $0
                                            </span>
                                        </div>
                                        <?php 
                                          // Lógica de WhatsApp igual que en Empresas > Marcas Rápidas
                                          $wa = isset($this->lc_cotizador_whatsapp) && is_array($this->lc_cotizador_whatsapp) ? $this->lc_cotizador_whatsapp : []; 
                                          $waBtn = $wa['boton'][0] ?? 'WhatsApp'; 
                                          $waHref = null;
                                          $ctrlLink = $this->lc_cotizador_whatsapp_link ?? null;
                                          if (is_string($ctrlLink) && preg_match('#^https?://#i', trim($ctrlLink))) { $waHref = trim($ctrlLink); }
                                          elseif (isset($wa['link'][0]) && is_string($wa['link'][0]) && preg_match('#^https?://#i', trim($wa['link'][0]))) { $waHref = trim($wa['link'][0]); }
                                          $waTel = $wa['telefono'][0] ?? ($wa['wa'][0] ?? null); 
                                          $waMsg = $wa['texto'][0] ?? null; 
                                          if (!$waHref && $waTel) { 
                                            $digits = preg_replace('/\D+/', '', $waTel); 
                                            if ($digits) { 
                                              $waHref = 'https://wa.me/' . $digits; 
                                              if (is_string($waMsg) && trim($waMsg) !== '') { $waHref .= '?text=' . rawurlencode($waMsg); }
                                            }
                                          }
                                          if ($waHref && is_string($waMsg) && trim($waMsg) !== '') {
                                            if (preg_match('#(wa\.me|whatsapp\.com)#i', $waHref)) {
                                              $waHref .= (strpos($waHref, '?') === false ? '?' : '&') . 'text=' . rawurlencode($waMsg);
                                            }
                                          }
                                        ?>
                                        <?php if ($waHref) { ?>
                                          <a href="<?php echo htmlspecialchars($waHref); ?>" target="_blank" rel="noopener" class="btn btn-success mt-2" style="background-color: #25D366; border: none; color: white; font-weight: bold; border-radius: 24px; padding: 10px 24px; font-size: 1.05rem; box-shadow: 0 2px 8px rgba(7,153,182,0.08);">
                                              Contactar un ejecutivo Likephone para cotizar <i class="fab fa-whatsapp"></i>
                                          </a>
                                        <?php } else { ?>
                                          <div class="mt-2" style="height:42px; width:360px; background:#cfe9d6; border-radius:24px;"></div>
                                        <?php } ?>
                                    </div>
                                </div>
                            </div>
                            <script>
                                 document.addEventListener('DOMContentLoaded', function() {
                                    const benefits = document.querySelectorAll('#benefits-list li');
                                    benefits.forEach((benefit, index) => {
                                        setTimeout(() => {
                                            benefit.style.opacity = '1';
                                            benefit.style.transform = 'translateX(0)';
                                            benefit.style.transition = 'all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                                        }, 800 + (index * 250));
                                    });
                                    
                                    // Definir variables para los botones primero
                                    const plusBtn = document.querySelector('.plus-btn');
                                    const minusBtn = document.querySelector('.minus-btn');
                                    const counterNumber = document.querySelector('.counter-number');
                                    
                                    if (plusBtn && minusBtn && counterNumber) {
                                        [plusBtn, minusBtn].forEach(btn => {
                                            btn.addEventListener('mouseenter', function() {
                                                this.style.transform = 'scale(1.1)';
                                                this.style.boxShadow = '0 6px 12px rgba(0,0,0,0.15)';
                                            });
                                            btn.addEventListener('mouseleave', function() {
                                                this.style.transform = 'scale(1)';
                                                this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
                                            });
                                        });
                                        function updateCounter(value) {
                                            counterNumber.style.transform = 'translateY(-10px)';
                                            counterNumber.style.opacity = '0.5';                     
                                            setTimeout(() => {
                                                counterNumber.textContent = value;
                                                counterNumber.style.transform = 'translateY(0)';
                                                counterNumber.style.opacity = '1';
                                                if (employeesText) {
                                                    const texto = value === 1 ? ' empleado' : ' empleados';
                                                    employeesText.innerHTML = value + texto;
                                                }
                                            }, 200);
                                        }
                                    }
                                    const likePhoneOption = document.querySelector('.likephone-option');
                                    const toggleSwitch = document.querySelector('.toggle-switch');
                                    const likephoneCounterContainer = document.querySelector('.likephone-counter-container').parentElement;
                                    const likephoneNewAmountContainer = document.querySelector('.likephone-new-amount-container');
                                    const likePhoneNote = document.querySelector('.likephone-note');
                                    let likePhoneActive = false;
                                     window.likePhoneActive = likePhoneActive;
                                    if (likephoneCounterContainer) {
                                        likephoneCounterContainer.style.display = 'none';
                                        }
                                    if (likephoneNewAmountContainer) {
                                         likephoneNewAmountContainer.style.display = 'none';
                                        }
                                   if (likePhoneNote) {
                                         likePhoneNote.style.display = 'none';
                                        }
                                     function updateLikeCheckAmount() {
                                    if (typeof window.updateLikeCheckAmount === 'function') {
                                    return window.updateLikeCheckAmount();
                                        }
                                    let colaboradores = parseInt(counterNumber ? counterNumber.textContent : '1');
                                    let lineas = 0;
                                    if (likePhoneActive) {
                                        lineas = parseInt(document.querySelector('.likephone-counter-number') ? document.querySelector('.likephone-counter-number').textContent : '0') || 0;
                                        }               
                                    let descuentan = lineas;
                                    let nuevosColaboradores = Math.max(colaboradores - descuentan, 0);
                                    let nuevoTotal = nuevosColaboradores * currentPrice;      
                                    let formatted = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(nuevoTotal);
                                    if (likecheckNewAmount) {
                                        likecheckNewAmount.textContent = formatted;
                                        }
                                        }                               
                                    if (likePhoneOption && toggleSwitch) {
                                        likePhoneOption.addEventListener('click', function() {
                                        likePhoneActive = !likePhoneActive;
                                        window.likePhoneActive = likePhoneActive;                                   
                                    if (likePhoneActive) {
                                        toggleSwitch.style.backgroundColor = '#4caf50';
                                        toggleSwitch.querySelector('.toggle-knob').style.right = '3px';
                                        toggleSwitch.querySelector('.toggle-knob').style.left = 'auto';                                          
                                    if (likephoneCounterContainer) {
                                        likephoneCounterContainer.style.display = 'block';
                                        }
                                    if (likephoneNewAmountContainer) {
                                        likephoneNewAmountContainer.style.display = 'flex';
                                        }
                                    if (likePhoneNote) {
                                        likePhoneNote.style.display = 'block';
                                        }                                              
                                    const likephoneCounterNumber = document.querySelector('.likephone-counter-number');
                                    if (likephoneCounterNumber && (parseInt(likephoneCounterNumber.textContent) || 0) < 1) {
                                        likephoneCounterNumber.textContent = '1';                                           
                                        updateLikeCheckAmount();
                                        }
                                    }else {
                                        toggleSwitch.style.backgroundColor = '#ccc';
                                        toggleSwitch.querySelector('.toggle-knob').style.right = 'auto';
                                        toggleSwitch.querySelector('.toggle-knob').style.left = '3px';                                     
                                    if (likephoneCounterContainer) {
                                        likephoneCounterContainer.style.display = 'none';
                                        }
                                    if (likephoneNewAmountContainer) {
                                        likephoneNewAmountContainer.style.display = 'none';
                                        }
                                    if (likePhoneNote) {
                                        likePhoneNote.style.display = 'none';
                                        }
                                    const likephoneCounterNumber = document.querySelector('.likephone-counter-number');
                                    if (likephoneCounterNumber) {
                                        likephoneCounterNumber.textContent = '0';
                                        }
                                        }                            
                                         updateLikeCheckAmount();
                                        });
                                    }
                                });
                            </script>                        
                            <div class="mt-5 text-center">
                                <?php if (!empty($agendaLink)) { ?>
                                  <a href="<?php echo htmlspecialchars((string)$agendaLink); ?>" class="btn btn-primary" target="_blank" rel="noopener" style="display:inline-flex; align-items:center; justify-content:center; gap:8px; background:linear-gradient(45deg,#00c2cb,#00a0bb); color:white; text-decoration:none; font-weight:600; padding:14px 50px; border-radius:10px; border:none; font-size:1.2rem; box-shadow:0 4px 15px rgba(0,194,203,0.3); transition:0.3s ease; cursor:pointer; min-width:260px;">
                                      AGENDA TU DEMO <i class="fas fa-chevron-right" style="margin-left: 4px;"></i>
                                  </a>
                                <?php } else { ?>
                                  <div style="height:48px; width:280px; background:#e1ecf5; border-radius:10px; margin:0 auto;"></div>
                                <?php } ?>
                            </div>
                        </div>
                    </div>
                </div>                
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                    const prices = { 'Mensual': 35, 'Semestral': 175, 'Anual': 300 };
                    let count = 1;
                    let likePhoneActive = false;
                    let currentPrice = 35;
                    const counterNumber = document.querySelector('.counter-number');
                    const totalPrice = document.getElementById('total-price');
                    const likeCheckAmount = document.getElementById('likecheck-new-amount');
                    const likephoneCounter = document.querySelector('.likephone-counter-number');
                    const likephoneContainer = document.querySelector('.likephone-counter-container')?.parentElement;
                    const likephoneAmountContainer = document.querySelector('.likephone-new-amount-container');
                    const likePhoneNote = document.querySelector('.likephone-note');
                    const likePhoneToggle = document.querySelector('.likephone-option');
                    const toggleSwitch = document.querySelector('.toggle-switch');
                    if (counterNumber) counterNumber.textContent = '1';
                    if (likephoneCounter) likephoneCounter.textContent = '0';
                    if (totalPrice) totalPrice.textContent = '$35';
                    if (likeCheckAmount) likeCheckAmount.textContent = '$0';
                    function updateCounter(num) {
                        if (!counterNumber) return;
                        counterNumber.style.transform = 'scale(1.2)';
                        setTimeout(() => {
                            counterNumber.textContent = num;
                            counterNumber.style.transform = 'scale(1)';
                        }, 100);
                    }
                    function calculateTotal() {
                        if (!totalPrice) return;
                        const total = currentPrice * count;
                        const formatted = new Intl.NumberFormat('es-MX', {
                            style: 'currency', currency: 'MXN', 
                            minimumFractionDigits: 0, maximumFractionDigits: 0
                        }).format(total);
                        
                        totalPrice.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            totalPrice.innerHTML = formatted;
                            totalPrice.style.transform = 'scale(1)';
                        }, 100);
                    }
                    function updateLikeCheckAmount() {
                        if (!likeCheckAmount) return;
                        
                        let lineas = 0;
                        if (likePhoneActive) {
                            lineas = parseInt(likephoneCounter?.textContent || '0');
                        }
                        
                        const nuevosColaboradores = Math.max(count - lineas, 0);
                        const total = nuevosColaboradores * currentPrice;
                        
                        const formatted = new Intl.NumberFormat('es-MX', {
                            style: 'currency', currency: 'MXN', 
                            minimumFractionDigits: 0, maximumFractionDigits: 0
                        }).format(total);
                        
                        likeCheckAmount.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            likeCheckAmount.innerHTML = formatted;
                            likeCheckAmount.style.transform = 'scale(1)';
                        }, 100);
                    }
                    document.querySelector('.plus-btn').onclick = function() {
                        count++;
                        updateCounter(count);
                        calculateTotal();
                        if (likePhoneActive) updateLikeCheckAmount();
                        updateEmployeeDisplay(count);
                    };
                    document.querySelector('.minus-btn').onclick = function() {
                        if (count > 1) {
                            count--;
                            updateCounter(count);
                            calculateTotal();
                            if (likePhoneActive) updateLikeCheckAmount();
                            updateEmployeeDisplay(count);
                        }
                    };
                    function updateEmployeeDisplay(count) {
                        var display = document.getElementById('employee-count-display');
                        if (display) {
                            display.textContent = count + (count === 1 ? ' empleado' : ' empleados');
                        }
                    }
                    function updateFrequencyDisplay(freq) {
                        var freqDisplay = document.getElementById('frequency-display');
                        if (freqDisplay) {
                            freqDisplay.textContent = 'Frecuencia de pago: ' + freq;
                        }
                    }                          
                    const periodBtns = document.querySelectorAll('.period-btn');
                    periodBtns.forEach(btn => {
                        btn.onclick = function() {
                            periodBtns.forEach(b => {
                                b.classList.remove('active');
                                b.style.background = 'rgba(255,255,255,0.2)';
                                b.style.color = 'white';
                                b.style.boxShadow = 'none';
                            });                          
                            this.classList.add('active');
                            this.style.background = 'white';
                            this.style.color = '#0799B6';
                            this.style.boxShadow = '0 3px 8px rgba(0,0,0,0.1)';
                            const frequency = this.getAttribute('data-frequency');
                            currentPrice = parseInt(this.getAttribute('data-price'));
                            
                            updateFrequencyDisplay(frequency);
                            calculateTotal();
                            if (likePhoneActive) updateLikeCheckAmount();
                        };
                    });
                    if (likePhoneToggle) {
                        likePhoneToggle.onclick = function() {
                            likePhoneActive = !likePhoneActive;                
                            if (likePhoneActive) {
                                if (toggleSwitch) {
                                    toggleSwitch.style.backgroundColor = '#4caf50';
                                    const knob = toggleSwitch.querySelector('.toggle-knob');
                                    if (knob) {
                                        knob.style.left = 'auto';
                                        knob.style.right = '3px';
                                    }
                                }
                                if (likephoneContainer) likephoneContainer.style.display = 'block';
                                if (likephoneAmountContainer) likephoneAmountContainer.style.display = 'flex';
                                if (likePhoneNote) likePhoneNote.style.display = 'block';
                                if (likephoneCounter && parseInt(likephoneCounter.textContent || '0') < 1) {
                                    likephoneCounter.textContent = '1';
                                }
                            } else {
                                if (toggleSwitch) {
                                    toggleSwitch.style.backgroundColor = '#ccc';
                                    const knob = toggleSwitch.querySelector('.toggle-knob');
                                    if (knob) {
                                        knob.style.left = '3px';
                                        knob.style.right = 'auto';
                                    }
                                }
                                if (likephoneContainer) likephoneContainer.style.display = 'none';
                                if (likephoneAmountContainer) likephoneAmountContainer.style.display = 'none';
                                if (likePhoneNote) likePhoneNote.style.display = 'none';
                                if (likephoneCounter) likephoneCounter.textContent = '0';
                            }                       
                            updateLikeCheckAmount();
                        };
                    }
                    document.querySelector('.likephone-plus-btn').onclick = function() {
                        if (!likephoneCounter) return;
                        let val = parseInt(likephoneCounter.textContent) || 0;
                        likephoneCounter.textContent = val + 1;
                        updateLikeCheckAmount();
                    };
                    
                    document.querySelector('.likephone-minus-btn').onclick = function() {
                        if (!likephoneCounter) return;
                        let val = parseInt(likephoneCounter.textContent) || 0;
                        if (val > 1) {
                            likephoneCounter.textContent = val - 1;
                            updateLikeCheckAmount();
                        }
                    };
                    
                    // 6. INICIALIZAR VALORES
                    calculateTotal();
                    // Habilitar edición manual en contadores
                    if (counterNumber) {
                        counterNumber.setAttribute('contenteditable', 'true');
                        counterNumber.setAttribute('inputmode', 'numeric');
                        
                        // Al teclear solo permite dígitos
                        counterNumber.addEventListener('input', function(e) {
                            // Permitir solo dígitos o dejar vacío
                            let text = this.textContent.replace(/[^0-9]/g, '');
                            
                            // Mantener posición del cursor
                            if (this.textContent !== text) {
                                const selection = window.getSelection();
                                const range = selection.getRangeAt(0);
                                const pos = range.startOffset;
                                
                                this.textContent = text;
                                
                                if (this.firstChild) {
                                    range.setStart(this.firstChild, Math.min(pos, text.length));
                                    range.collapse(true);
                                    selection.removeAllRanges();
                                    selection.addRange(range);
                                }
                            }
                            
                            // Actualizar valores si no está vacío
                            if (text !== '') {
                                let val = parseInt(text);
                                count = val;
                                calculateTotal();
                                if (likePhoneActive) updateLikeCheckAmount();
                                updateEmployeeDisplay(count);
                            }
                        });
                        
                        // Al perder el foco, verificar valor mínimo
                        counterNumber.addEventListener('blur', function() {
                            let val = parseInt(this.textContent) || 0;
                            if (val < 1 || this.textContent.trim() === '') {
                                this.textContent = '1';
                                count = 1;
                                calculateTotal();
                                if (likePhoneActive) updateLikeCheckAmount();
                                updateEmployeeDisplay(count);
                            }
                        });
                    }
                    if (likephoneCounter) {
                        likephoneCounter.setAttribute('contenteditable', 'true');
                        likephoneCounter.setAttribute('inputmode', 'numeric');
                        
                        // Al teclear solo permite dígitos
                        likephoneCounter.addEventListener('input', function(e) {
                            // Permitir solo dígitos o dejar vacío
                            let text = this.textContent.replace(/[^0-9]/g, '');
                            
                            // Mantener posición del cursor
                            if (this.textContent !== text) {
                                const selection = window.getSelection();
                                const range = selection.getRangeAt(0);
                                const pos = range.startOffset;
                                
                                this.textContent = text;
                                
                                if (this.firstChild) {
                                    range.setStart(this.firstChild, Math.min(pos, text.length));
                                    range.collapse(true);
                                    selection.removeAllRanges();
                                    selection.addRange(range);
                                }
                            }
                            
                            // Actualizar valores siempre
                            updateLikeCheckAmount();
                        });
                        
                        // Al perder el foco, verificar valor mínimo
                        likephoneCounter.addEventListener('blur', function() {
                            let val = parseInt(this.textContent) || 0;
                            if (val < 1 || this.textContent.trim() === '') {
                                this.textContent = '1';
                                updateLikeCheckAmount();
                            }
                        });
                    }
                    });
                </script>
            </script>
            <style>
                @keyframes float {
                    0% { transform: translate(0, 0) rotate(0deg); }
                    50% { transform: translate(20px, 20px) rotate(10deg); }
                    100% { transform: translate(0, 0) rotate(0deg); }
                }               
                @keyframes pulse {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                    100% { transform: scale(1); }
                }             
                @keyframes fadeInDown {
                    from { opacity: 0; transform: translateY(-20px); }
                    to { opacity: 1; transform: translateY(0); }
                }      
                @keyframes fadeInLeft {
                    from { opacity: 0; transform: translateX(-30px); }
                    to { opacity: 1; transform: translateX(0); }
                }
                @keyframes fadeInRight {
                    from { opacity: 0; transform: translateX(30px); }
                    to { opacity: 1; transform: translateX(0); }
                }
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }             
                @keyframes bounceIn {
                    0% { transform: scale(0.3); opacity: 0; }
                    50% { transform: scale(1.1); }
                    70% { transform: scale(0.9); }
                    100% { transform: scale(1); opacity: 1; }
                }          
                .hover-lift:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                }                
                .period-btn:hover {
                    background-color: #182c83 !important;
                    color: white !important;
                    transform: scale(1.05);
                }               
                #cotizador-content .btn-circle:hover {
                    transform: scale(1.1);
                    box-shadow: 0 0 10px rgba(24, 44, 131, 0.5);
                }        
                #cotizador-content .btn-primary:hover i {
                    transform: translateX(3px);
                }
                @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap');
            </style>          
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                });
            </script>
        </div>
